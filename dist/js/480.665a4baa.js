"use strict";(self["webpackChunkvue_losev_frontend"]=self["webpackChunkvue_losev_frontend"]||[]).push([[480],{7480:function(t,s,e){e.r(s),e.d(s,{default:function(){return E}});var o=e(3396),a=e(7139),i=e(9242);const l={class:"view_all"},c={key:0,class:"loading"},n={key:1,class:"block_content_podcast"},d={key:0,class:"blocked-overlay"},r=(0,o._)("svg",{class:"lock-icon",xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 448 512"},[(0,o._)("path",{d:"M144 144v48H304V144c0-44.2-35.8-80-80-80s-80 35.8-80 80zM80 192V144C80 64.5 144.5 0 224 0s144 64.5 144 144v48h16c35.3 0 64 28.7 64 64V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V256c0-35.3 28.7-64 64-64H80z"})],-1),p=["onClick"],h={class:"positions_in_block"},u={class:"upper_tittle"},g={class:"context"},v=["disabled","onClick"],m={class:"play-icon",xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 512 512"},y=["d"],P={class:"info_podcast"},_={class:"title_podcast"},k={class:"author_podcast"},w={class:"time_podcast"},b={class:"under_title"},f={class:"rating_and_categories"},z={class:"podcast-rating"},A={class:"categories_podcast"},S=["onClick"],$={key:2,class:"payment-popup"},L={class:"payment-popup-content"},q=(0,o._)("p",null,"Виберіть метод оплати",-1),C={class:"container_payment"},F={class:"ones_payment_metod"},x=(0,o._)("svg",{class:"payment-logo",xmlns:"http://www.w3.org/2000/svg",viewBox:"119.5 203.6 221 28.8"},[(0,o._)("path",{fill:"red",d:"M119.5 207.7h4.5v2.6c1.3-1.9 3.4-3.1 5.7-3 2.1 0 4.1.9 5.4 2.5 1.5 1.6 2.2 3.9 2.2 6.8 0 3-.7 5.3-2.2 7-1.4 1.6-3.3 2.5-5.4 2.5-.9 0-1.9-.2-2.7-.6-1-.5-1.9-1.2-2.6-2v9h-4.9v-24.8zm4.8 8.6c0 2 .4 3.5 1.2 4.5.7.9 1.8 1.5 3 1.4 1.1 0 2.1-.5 2.8-1.3.7-.9 1.1-2.3 1.1-4.3 0-1.9-.4-3.3-1.2-4.2-.7-.9-1.7-1.4-2.9-1.4-1.1 0-2.2.5-2.9 1.3-.7.9-1.1 2.3-1.1 4zm14.9.1c0-1.6.4-3.2 1.2-4.6.8-1.4 1.9-2.6 3.4-3.4 1.5-.8 3.2-1.2 4.9-1.2 2.5-.1 5 .9 6.8 2.6 1.8 1.8 2.7 4.2 2.7 6.7.1 5.1-3.8 9.3-8.9 9.4h-.5c-1.7 0-3.3-.4-4.8-1.1-1.5-.7-2.7-1.8-3.5-3.3-1-1.5-1.4-3.3-1.3-5.1zm5 .2c0 1.8.4 3.1 1.3 4.1 1.6 1.8 4.3 1.9 6 .3l.3-.3c.9-.9 1.3-2.3 1.3-4.1 0-1.8-.4-3.1-1.3-4.1-1.6-1.8-4.3-1.9-6-.3l-.3.3c-.9 1-1.3 2.3-1.3 4.1zm38.4-8.9v3.8h-3.3v7.2c0 .9 0 1.7.1 2.6.1.2.2.5.4.6.2.2.5.2.8.2.7 0 1.3-.2 1.9-.5l.4 3.7c-1.2.5-2.5.7-3.8.7-.8 0-1.6-.1-2.4-.4-.6-.2-1.1-.6-1.5-1.1-.4-.6-.6-1.2-.7-1.8-.1-1.1-.2-2.2-.2-3.3v-7.8h-2.2v-3.8h2.2v-2.4l4.9-1.6v4.1h3.4v-.2zm2.6 0h4.5v2.5c1.6-1.9 3.5-2.9 5.7-2.9 1.1 0 2.1.2 3.1.7.9.5 1.6 1.2 2.1 2.1.7-.9 1.6-1.6 2.6-2.1.9-.5 2-.7 3-.7 1.2 0 2.4.2 3.4.8.9.5 1.7 1.4 2.1 2.4.3.8.5 2 .5 3.7v11.5h-4.9v-10.3c0-1.8-.2-2.9-.5-3.4-.5-.7-1.3-1.1-2.1-1-1.5 0-2.8 1-3.2 2.4-.3 1.2-.5 2.5-.4 3.7v8.6h-4.9v-9.8c0-1.7-.1-2.9-.3-3.4-.1-.5-.4-.9-.8-1.1-.4-.3-1-.4-1.5-.4-.7 0-1.4.2-2 .6-.6.4-1.1 1-1.3 1.7-.3 1.2-.4 2.5-.4 3.7v8.7H185l.2-18zm28.8 8.7c0-1.6.4-3.2 1.2-4.6.8-1.4 1.9-2.6 3.4-3.4 1.5-.8 3.2-1.2 4.9-1.2 2.8 0 5 .9 6.8 2.6 1.8 1.8 2.7 4.2 2.7 6.7.1 5.1-3.8 9.3-8.9 9.4h-.5c-1.7 0-3.3-.4-4.8-1.1-1.5-.7-2.7-1.8-3.5-3.3-.9-1.5-1.3-3.3-1.3-5.1zm5 .2c0 1.8.4 3.1 1.3 4.1 1.6 1.8 4.3 1.9 6 .3l.3-.3c.9-.9 1.3-2.3 1.3-4.1 0-1.8-.4-3.1-1.3-4.1-1.6-1.8-4.3-1.9-6-.3l-.3.3c-.9 1-1.3 2.3-1.3 4.1zm32.5 9h-4.8v-9.2c0-1.9-.1-3.2-.3-3.8-.2-.5-.5-1-1-1.3-.5-.3-1.1-.5-1.7-.5-.8 0-1.6.2-2.3.7-.6.4-1.1 1.1-1.4 1.8-.2.7-.4 2.1-.4 4.1v8.1h-4.9v-17.9h4.5v2.6c1.4-1.9 3.7-3.1 6-3 1 0 2 .2 2.9.6.8.3 1.5.8 2 1.4.5.6.8 1.3.9 2 .2 1.1.3 2.1.3 3.2l.2 11.2zm14.4-5.7l4.8.8c-.5 1.6-1.6 3-2.9 4-1.5 1-3.3 1.4-5 1.4-3.2 0-5.5-1-7.1-3.1-1.2-1.6-1.8-3.7-1.8-6.2 0-3 .8-5.3 2.4-7 1.5-1.7 3.7-2.6 6-2.5 2.7 0 4.9.9 6.4 2.6 1.6 1.8 2.3 4.5 2.3 8.1h-12.1c0 1.2.4 2.4 1.2 3.3.7.8 1.7 1.2 2.8 1.2.7 0 1.4-.2 1.9-.6.5-.6.9-1.3 1.1-2zm.3-4.8c0-1.4-.4-2.4-1.1-3.1-1.4-1.4-3.6-1.4-5-.1l-.1.1c-.7.9-1.1 2-1 3.1h7.2zm-97.3-3.2c-2.2 0-3.9 1.4-3.9 4.5v9.3h-4.9v-17.9h4.2v3.1h.1c.9-2.3 2.8-3.5 4.5-3.5.4 0 .7 0 1.1.1v4.5c-.3-.1-.7-.2-1.1-.1z"}),(0,o._)("path",{fill:"#A7A9AB",d:"M273.9 225.4V222h3.5v3.5h-3.5zm18.4-6.5l3.1.4c-.2 1.9-1.1 3.6-2.6 4.8-1.4 1.2-3.2 1.8-5 1.7-2.5 0-4.5-.8-6-2.4-1.5-1.6-2.3-3.9-2.3-6.9 0-1.7.3-3.5 1-5.1.6-1.4 1.6-2.5 3-3.3 1.3-.7 2.8-1.1 4.4-1.1 1.7-.1 3.5.4 4.9 1.5 1.3 1 2.2 2.5 2.4 4.2l-3 .4c-.2-1-.7-2-1.5-2.7-.7-.6-1.7-.9-2.6-.9-1.4-.1-2.8.6-3.8 1.6-1 1.1-1.5 2.8-1.5 5.2 0 2.4.5 4.2 1.4 5.2.9 1.1 2.3 1.7 3.7 1.6 1.1 0 2.2-.4 3-1.1.7-.5 1.2-1.6 1.4-3.1zm4.5-2.4c0-3.3.9-5.8 2.8-7.4 1.6-1.3 3.7-2 5.7-2 2.3-.1 4.5.8 6.2 2.4 1.6 1.6 2.4 3.8 2.4 6.7 0 2.3-.4 4.1-1.1 5.4-.7 1.3-1.8 2.4-3.1 3.1-1.4.7-2.9 1.1-4.4 1.1-2.6 0-4.6-.8-6.2-2.4-1.5-1.6-2.3-3.9-2.3-6.9zm3.2 0c0 2.3.5 4 1.5 5.2 1.9 2.1 5.2 2.3 7.3.4l.4-.4c1-1.2 1.5-2.9 1.5-5.2 0-2.2-.5-3.9-1.5-5-1.9-2.1-5.2-2.3-7.3-.4-.1.1-.3.2-.4.4-1 1-1.5 2.7-1.5 5zm15.7 8.9v-17.9h2.8v2.5c.6-.9 1.4-1.6 2.3-2.1 1-.5 2.1-.8 3.2-.8 1.2 0 2.3.2 3.3.8.9.5 1.5 1.4 1.8 2.3 1.5-2.1 3.3-3.1 5.7-3.1 1.8 0 3.2.5 4.2 1.5s1.5 2.5 1.5 4.5v12.3h-3.1v-11.3c0-.9-.1-1.8-.3-2.6-.2-.5-.6-1-1.1-1.3-.6-.3-1.2-.5-1.9-.5-1.2 0-2.4.4-3.2 1.3-.8.8-1.3 2.2-1.3 4v10.4h-3.1v-11.6c0-1.4-.3-2.4-.8-3-.5-.7-1.3-1-2.5-1-.9 0-1.7.2-2.4.7-.7.5-1.3 1.1-1.6 2-.4 1.2-.6 2.5-.5 3.7v9.3l-3-.1z"})],-1),M={class:"button_payment"};function I(t,s,e,I,V,B){const D=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",l,[(0,o._)("p",null,[(0,o.Wm)(D,{to:"/"},{default:(0,o.w5)((()=>[(0,o.Uk)("Головна")])),_:1}),(0,o.Uk)(" > "),(0,o.Wm)(D,{to:"/all-top-podcasts"},{default:(0,o.w5)((()=>[(0,o.Uk)("Топ прослуховувань")])),_:1})])]),V.loading?((0,o.wg)(),(0,o.iD)("div",c,"Завантаження...")):((0,o.wg)(),(0,o.iD)("div",n,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(V.podcasts,(t=>(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",{key:t.id,class:(0,a.C_)(["podcast",`id_${t.id}`,{podcast_blocked:t.blocked}]),style:(0,a.j5)({backgroundImage:`url(${t.image_url})`,backgroundRepeat:"no-repeat",backgroundPosition:"center"})},[t.blocked?((0,o.wg)(),(0,o.iD)("div",d,[r,(0,o._)("button",{class:"buy-button",onClick:s=>B.openPaymentPopup(t.id)},"Купити",8,p)])):(0,o.kq)("",!0),(0,o._)("div",h,[(0,o._)("div",u,[(0,o._)("div",g,[(0,o._)("button",{class:"play-button",disabled:t.blocked,"aria-label":"Play podcast",onClick:s=>!t.blocked&&B.handlePlayButtonClick(t,s)},[((0,o.wg)(),(0,o.iD)("svg",m,[(0,o._)("path",{class:"play-path",d:B.isPlaying&&V.playingPodcast===t.id?V.pausePath:V.playPath},null,8,y)]))],8,v),(0,o._)("div",P,[(0,o._)("span",_,(0,a.zw)(B.truncateTitle(t.title)),1),(0,o._)("span",k,(0,a.zw)(t.author),1)])]),(0,o._)("span",w,(0,a.zw)(t.duration),1)]),(0,o._)("div",b,[(0,o._)("div",f,[(0,o._)("div",z,(0,a.zw)(t.rating),1),(0,o._)("span",A,(0,a.zw)(t.categories&&t.categories.length>0?t.categories[0].name:"Невідомо"),1)]),(0,o._)("button",{class:(0,a.C_)(["heart-button",t.isFavorite?"active":""]),"aria-label":"favorite",onClick:s=>B.handleHeartButtonClick(t)},null,10,S)])])],6)),[[i.F8,t.isVisible]]))),128))])),V.showPaymentPopup?((0,o.wg)(),(0,o.iD)("div",$,[(0,o._)("div",L,[q,(0,o._)("div",C,[(0,o._)("div",F,[(0,o._)("label",null,[(0,o.wy)((0,o._)("input",{type:"radio",required:"",value:"portmone","onUpdate:modelValue":s[0]||(s[0]=t=>V.selectedPaymentMethod=t)},null,512),[[i.G2,V.selectedPaymentMethod]]),x])]),(0,o._)("div",M,[(0,o._)("button",{onClick:s[1]||(s[1]=(...t)=>B.makePayment&&B.makePayment(...t))},"Оплатити"),(0,o._)("button",{onClick:s[2]||(s[2]=(...t)=>B.closePaymentPopup&&B.closePaymentPopup(...t))},"Скасувати")])])])])):(0,o.kq)("",!0)],64)}e(7658);var V=e(3258),B=e(5797),D=e.n(B),H={name:"AllTopPodcast",data(){return{podcasts:[],loading:!1,initialPodcasts:[],playingPodcast:null,audio:new Audio,playPath:"M0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM188.3 147.1c-7.6 4.2-12.3 12.3-12.3 20.9V344c0 8.7 4.7 16.7 12.3 20.9s16.8 4.1 24.3-.5l144-88c7.1-4.4 11.5-12.1 11.5-20.5s-4.4-16.1-11.5-20.5l-144-88c-7.4-4.5-16.7-4.7-24.3-.5z",pausePath:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM224 192V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V192c0-17.7 14.3-32 32-32s32 14.3 32 32zm128 0V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V192c0-17.7 14.3-32 32-32s32 14.3 32 32z",showPaymentPopup:!1,selectedPaymentMethod:"",selectedPodcastId:null,isAuthenticated:!1}},computed:{isPlaying(){return console.log("isPlaying value from store:",this.$store.getters.isPlaying),this.$store.getters.isPlaying},playingPodcastId(){return this.$store.getters.playingPodcast.id},isPodcastFavorite(){return t=>this.$store.getters.isFavorite(t.id)}},watch:{isPlaying(t){!0===t?this.startAnimation():!1===t&&this.stopAnimation()}},methods:{openPaymentPopup(t){this.isAuthenticated?(this.selectedPodcastId=t,this.showPaymentPopup=!0):this.$router.push("/login")},closePaymentPopup(){this.selectedPodcastId=null,this.showPaymentPopup=!1},async makePayment(){const t=localStorage.getItem("token");console.log("podcast.id= "+this.selectedPodcastId);const s=this.selectedPodcastId;if("portmone"===this.selectedPaymentMethod)try{const e=await V.Z.submitPaymentPodcast(t,s,this.selectedPaymentMethod);e&&e.data&&e.data.order_link?window.location.href=e.data.order_link:e.error&&e.error.message&&"You need to login before continue"===e.error.message?D().toast({html:"Ви не авторизовані"}):console.error("Не вдалося отримати посилання для оплати")}catch(e){console.error("Помилка при оплаті:",e)}this.closePaymentPopup()},startAnimation(){console.log("start animation");const t=document.querySelector(`.podcast.id_${this.playingPodcastId}`);t&&(this.isPlaying=!this.isPlaying,this.playingPodcast=this.playingPodcastId,t.querySelector(".positions_in_block").classList.add("active"),t.classList.add("active"),t.querySelector(".context").classList.add("reversed"),t.querySelector(".play-button").classList.add("expanded"))},stopAnimation(){console.log("stop animation");const t=document.querySelector(`.podcast.id_${this.playingPodcast}`);t&&(t.querySelector(".positions_in_block").classList.remove("active"),t.classList.remove("active"),t.querySelector(".context").classList.remove("reversed"),t.querySelector(".play-button").classList.remove("expanded"),this.playingPodcast=null),console.log("stop this.playingPodcast= "+this.playingPodcast)},async handleHeartButtonClick(t){t.isFavorite=!t.isFavorite,console.log(t.isFavorite),this.$store.dispatch("toggleFavorite",t.id);const s=localStorage.getItem("token");try{const e=await V.Z.addAndRemoveToFavorite(s,t.id,`${this.$store.getters.isFavorite(t.id)}`);!0===e.data?(console.log("Операція успішна",e),this.$store.dispatch("updateIsFavoriteForPlayingPodcast",this.$store.getters.isFavorite(t.id))):e.error&&e.error.message&&"You need to login before continue"===e.error.message?D().toast({html:"Ви не авторизовані"}):null===e.data?console.error("Дані про улюблені подкасти ще не отримано:",e):console.error("Отримана неочікувана відповідь з сервера:",e)}catch(e){console.error("Помилка при додаванні або видаленні з улюблених:",e)}},stopPlayingPodcast(){const t=document.querySelector(`.podcast.id_${this.playingPodcast}`);t&&t.classList.remove("active");const s=document.querySelectorAll(".positions_in_block.active");s.forEach((t=>{t.classList.remove("active")}));const e=document.querySelectorAll(".podcast.active");e.forEach((t=>{t.classList.remove("active")}));const o=document.querySelectorAll(".context");o.forEach((t=>{t.classList.remove("reversed")}));const a=document.querySelectorAll(".play-button");a.forEach((t=>{t.classList.remove("expanded")})),this.playingPodcast=null,this.audio.removeEventListener("ended",this.stopPlayingPodcast.bind(this))},handlePlayButtonClick(t,s){if(this.playingPodcast===t.id?(this.$store.dispatch("togglePlayStatus"),this.isPlaying||this.stopPlayingPodcast(),this.playingPodcast=null):(null!==this.playingPodcast&&this.stopPlayingPodcast(),this.playingPodcast=t.id,this.$store.dispatch("updatePlayingPodcast",{imageUrl:t.image_url,author:t.author,title:t.title,duration:t.duration,id:t.id,audio_url:t.audio_url,isFavorite:t.isFavorite})),console.log("this.playingPodcast= "+this.playingPodcast),console.log("this.isPlaying= "+this.isPlaying),this.playingPodcast==t.id&&1==this.isPlaying){let t=s.target.closest(".positions_in_block");t.classList.toggle("active");let e=s.target.closest(".podcast");e.classList.toggle("active");const o=e.querySelector(".context");o.classList.toggle("reversed");const a=e.querySelector(".play-button");a.classList.toggle("expanded")}},async fetchPodcastDurations(){for(let t of this.podcasts){let s=new Audio(t.audio_url);s.addEventListener("loadedmetadata",(()=>{t.duration=this.formatTime(s.duration)}))}},formatTime(t){const s=Math.floor(t/60),e=Math.floor(t-60*s);return`${this.padZero(s)}:${this.padZero(e)}`},padZero(t){return t<10?`0${t}`:t},truncateTitle(t){return t.length>14?t.substring(0,14)+"...":t},applyAnimationBasedOnState(){this.isPlaying?this.startAnimation():this.stopAnimation()}},mounted(){this.loading=!0,this.applyAnimationBasedOnState();const t=localStorage.getItem("token");Promise.all([V.Z.getFavoritePodcasts(t),V.Z.TopPodcastPage(t)]).then((([t,s])=>{console.log("favoritePodcastsResponse:",t),console.log("userPodcastsResponse:",s.data);const e=t.data?t.data.map((t=>t.id)):[];console.log("userPodcastsResponse:",e),console.log("Before setting podcasts:",this.podcasts),this.podcasts=s?.data?.map((t=>({...t,isVisible:!0,isFavorite:e.includes(t.id)})))||[],console.log("After setting podcasts:",this.podcasts),console.log("Number of podcasts:",this.podcasts.length),this.$nextTick((()=>{this.fetchPodcastDurations()}))})).catch((t=>{console.error("Error:",t)})).finally((()=>{this.loading=!1}))},async created(){this.loading=!0;const t=localStorage.getItem("token");this.isAuthenticated=Boolean(t),this.loading=!1}},T=e(89);const Z=(0,T.Z)(H,[["render",I]]);var E=Z}}]);
//# sourceMappingURL=480.665a4baa.js.map